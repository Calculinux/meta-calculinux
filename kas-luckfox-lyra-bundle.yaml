# https://github.com/siemens/kas/blob/master/docs/userguide.rst
header:
  version: 18
  includes:
    - kas-base.yaml

machine: luckfox-lyra
target:
  - calculinux-bundle
  - packagegroup-meta-calculinux-apps

# walnascar checkout
repos:
  meta-arm:
    url: https://git.yoctoproject.org/meta-arm
    commit: 2de04c3d31e119d4bedbea24b9c63a8c113a1ce3
    layers:
      meta-arm-bsp:
      meta-arm-toolchain:
      meta-arm:
  meta-rockchip:
    url: https://github.com/JeffyCN/meta-rockchip.git
    commit: 71aa531a2018724a713c9587059bc53fcbd05a23
    layers:
      .:
  meta-rtlwifi:
    url: https://github.com/EmbeddedAndroid/meta-rtlwifi.git
    commit: 17a54f8a3c428039ff33c5a8ff8e045b466204b3
    layers:
      .:
    patches:
      0001-rtlwifi-changes.patch:
        repo: meta-calculinux
        path: patches/rtlwifi.patch
  meta-rauc:
    url: https://github.com/rauc/meta-rauc.git
    commit: a0b83842d131093e89fa4fefaaa1997f05afdf62
  meta-calculinux:
    layers:
      meta-calculinux-distro:
      meta-picocalc-bsp-rockchip:
      meta-calculinux-apps:
      meta-meshtastic:
local_conf_header:
  image: |
    INHERIT:append = " rockchip-image"
    
    WIFI_FIRMWARE = "\
      linux-firmware-rtl8192cu \
      linux-firmware-rtl8192su \
      linux-firmware-rtl8723 \
      linux-firmware-rtl8821 \
      linux-firmware-rtl8822 \
      linux-firmware-ath9k \
      linux-firmware-ath6k \
      linux-firmware-ralink \
      linux-firmware-mt7601u \
      linux-firmware-mt7650 \
      linux-firmware-mt76x2 \
      linux-firmware-bcm43xx \
      linux-firmware-bcm43430 \
      linux-firmware-bcm43455 \
    "
    
    EXTRA_WIFI_DRIVERS = "\
      aic8800 \
      rtl8188fu \
      rtl8723du \
      rtl8812au \
      rtl8814au \
      rtl8821cu \
      rtl88x2bu \
      rtl8733bu \
    "

    PICOCALC_DRIVERS = "\
      picocalc-drivers-lcd-drm \
      picocalc-drivers-snd-pwm \
      picocalc-drivers-snd-softpwm \
      picocalc-drivers-mfd \
    "

    CORE_IMAGE_EXTRA_INSTALL += " ${WIFI_FIRMWARE} ${EXTRA_WIFI_DRIVERS} ${PICOCALC_DRIVERS} "

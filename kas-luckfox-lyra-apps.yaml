# https://github.com/siemens/kas/blob/master/docs/userguide.rst
header:
  version: 18
  includes:
    - kas-base.yaml

machine: luckfox-lyra
target: packagegroup-meta-calculinux-apps

# scarthgap checkout
repos:
  meta-arm:
    url: https://git.yoctoproject.org/meta-arm
    commit: 2de04c3d31e119d4bedbea24b9c63a8c113a1ce3
    layers:
      meta-arm-bsp:
      meta-arm-toolchain:
      meta-arm:
  meta-rockchip:
    url: https://github.com/JeffyCN/meta-rockchip.git
    commit: 71aa531a2018724a713c9587059bc53fcbd05a23
    layers:
      .:
  meta-rauc:
    url: https://github.com/rauc/meta-rauc.git
    commit: a0b83842d131093e89fa4fefaaa1997f05afdf62
  meta-calculinux:
    layers:
      meta-picocalc-bsp-rockchip:
      meta-calculinux-apps:

local_conf_header:
  image: |
    INHERIT:append = " rockchip-image"
  standard: |
    PATCHRESOLVE = "noop"
    PACKAGE_CLASSES = "package_ipk"
    RM_OLD_IMAGE = "1"
    INHERIT += "rm_work"
    KERNEL_CLASSES += "kernel-fitimage"
    KERNEL_IMAGETYPES += "fitImage"
  diskmon: |
    BB_DISKMON_DIRS ??= "\
        STOPTASKS,${TMPDIR},1G,100K \
        STOPTASKS,${DL_DIR},1G,100K \
        STOPTASKS,${SSTATE_DIR},1G,100K \
        STOPTASKS,/tmp,100M,100K \
        HALT,${TMPDIR},100M,1K \
        HALT,${DL_DIR},100M,1K \
        HALT,${SSTATE_DIR},100M,1K \
        HALT,/tmp,10M,1K"
  rust_config: |
    # Enable Rust packages
    PACKAGECONFIG:pn-glkcli = ""
  apps_config: |
    # GLK Interactive Fiction configuration
    
    # Default interpreter engines for glkterm
    #PACKAGECONFIG:pn-glkterm = "bocfel glulxe git hugo level9 magnetic scare scott tads"
    
    # Add our package group to the image
    #CORE_IMAGE_EXTRA_INSTALL:append = " packagegroup-meta-calculinux-apps"
    
    # Preferred versions (use git live versions)
    PREFERRED_VERSION_glkterm = "1.0+git%"
    PREFERRED_VERSION_glkcli = "1.0+git%"